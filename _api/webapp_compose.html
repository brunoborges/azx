---
title: Web App | Multi Container
description: Create a Web App using Docker Compose, Allowing multiple containers.
author: Rob Conery
group: Web
---
#!/bin/bash

###### CHANGE THESE AS NEEDED #######
RG="AZX"
LOCATION="West US"
APPNAME="WPMULTI$RANDOM"

#The sku should be one of:
#D1(Shared), B1(Basic Small), B2(Basic Medium), B3(Basic Large), 
#S1(Standard Small), P1(Premium Small), P1V2(Premium V2 Small), 
#PC2 (Premium Container Small), PC3 (Premium Container Medium), 
#PC4 (Premium Container Large).

#accepted values: B1, B2, B3, D1, P1, P1V2, P2, P2V2, P3, P3V2, PC2, PC3, PC4, S1, S2, S3, SHARED
#S1 is a good choice for this setup as it needs some horsepower. Also...
#FREE is not valid for --is-linux for some reason
SKU=S1

#This is your Docker Compose YAML file. Edit as you need or, if you want
#Pop it into its own file. Up to you.
#I'm using Wordpress here as a way to show a basic docker compose file.
cat << configyml > config.yml 
version: '3.3' 

services:
   db:
     image: mysql:5.7
     volumes:
       - db_data:/var/lib/mysql
     restart: always
     environment:
       MYSQL_ROOT_PASSWORD: somewordpress
       MYSQL_DATABASE: wordpress
       MYSQL_USER: wordpress
       MYSQL_PASSWORD: wordpress

   wordpress:
     depends_on:
       - db
     image: wordpress:latest
     ports:
       - "8000:80"
     restart: always
     environment:
       WORDPRESS_DB_HOST: db:3306
       WORDPRESS_DB_USER: wordpress
       WORDPRESS_DB_PASSWORD: wordpress
volumes:
    db_data:
configyml

echo "Creating Resource Group"
az group create -n $RG --location $LOCATION

echo "Creating AppService Plan"
az appservice plan create --name $APPNAME \
                          --resource-group $RG \
                          --is-linux \
                          --sku $SKU

echo "Creating Web app"
az webapp create --resource-group $RG \
                  --plan $APPNAME \
                  --name $APPNAME \
                  --multicontainer-config-type compose \
                  --multicontainer-config-file config.yml

echo "Setting up logging"
az webapp log config --application-logging true \
                    --detailed-error-messages true \
                    --web-server-logging filesystem \
                    --level information \
                    --name $APPNAME \
                    --resource-group $RG

echo "Adding logs alias to .env. Invoking this will allow you to see the application logs realtime-ish."

#set an alias for convenience - add to .env
echo "alias logs='az webapp log tail -n $APPNAME -g $RG'" >> .env

echo "Opening site and viewing logs"
open https://$APPNAME.azurewebsites.net
source .env
logs